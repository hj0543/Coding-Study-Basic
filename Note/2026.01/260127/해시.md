
# 📝 해시 가능성(Hashable)과 불변성(Immutability)

"리스트는 딕셔너리의 키가 될 수 없다"는 에러(`TypeError: unhashable type: 'list'`)의 원인을 파악한다.

## 1. 가변 vs 불변 (Mutable vs Immutable)

데이터의 값이 생성된 후에 변경될 수 있는지를 기준으로 나눈다.

### ① Mutable (가변 객체)

* **정의**: 생성 후에도 상태(내용)를 변경할 수 있는 객체이다.
* **종류**: `list`, `set`, `dict`
* **특징**: 값을 변경해도 메모리 주소(id)가 바뀌지 않고 그 자리에서 내용만 바뀐다.

### ② Immutable (불변 객체)

* **정의**: 생성 후에는 상태를 변경할 수 없는 객체이다.
* **종류**: `int`, `float`, `str`, `tuple`, `bool`
* **특징**: 값을 바꾸려 하면 아예 **새로운 객체**를 생성하고 변수가 그것을 가리키게 한다.

---

## 2. 해시 가능성 (Hashable)

어떤 객체를 "고유한 정수 값(해시 값)"으로 변환할 수 있는 성질을 말한다.

* **해시(Hash) 값**: 데이터를 식별하기 위한 고유한 지문(Fingerprint)과 같다.
* **조건**: 객체의 수명 동안 **해시 값이 변하지 않아야** 해시 가능하다(Hashable)고 한다.

### 💡 핵심 공식

> **"불변(Immutable) 객체는 Hashable하다."**
> **"가변(Mutable) 객체는 Unhashable하다."**

* **불변 객체**(`str`, `tuple` 등)는 값이 안 변하므로 해시 값도 평생 고정된다. → **가능**
* **가변 객체**(`list` 등)는 값이 수시로 변하므로 해시 값도 계속 변해야 한다. → **불가능**

---

## 3. 왜 리스트는 딕셔너리의 Key나 세트의 요소가 될 수 없는가?

딕셔너리와 세트는 데이터를 빠르게 찾기 위해 **해시 테이블(Hash Table)** 구조를 사용하기 때문이다.

### 작동 원리와 문제점

1. 딕셔너리는 Key의 **해시 값**을 계산하여 저장 위치를 결정한다.
2. 만약 리스트가 Key가 될 수 있다고 가정해보자.
* `my_list = [1, 2]`의 해시 값을 계산해 저장했다.
* `my_list.append(3)`을 하여 `[1, 2, 3]`이 되었다.
* 내용이 바뀌었으므로 해시 값도 바뀌어야 한다.


3. **결과**: 나중에 이 Key로 값을 찾으려 할 때, 처음에 저장했던 위치와 계산된 위치가 달라져서 **데이터를 영영 찾을 수 없게 된다.**
4. 따라서 파이썬은 **가변 객체를 Key로 쓰는 것을 원천 봉쇄**한다.

---

## 4. 코드 예시 및 검증

### ① 해시 가능 여부 확인 (`hash()` 함수)

```python
# 불변 객체 (Hashable)
print(hash(10))        # 정수: 가능
print(hash('Hello'))   # 문자열: 가능
print(hash((1, 2)))    # 튜플: 가능

# 가변 객체 (Unhashable)
# print(hash([1, 2]))  # TypeError: unhashable type: 'list'
# print(hash({1, 2}))  # TypeError: unhashable type: 'set'

```

### ② 딕셔너리 Key 사용 시도

```python
# 불가능한 예 (리스트)
my_list = [1, 2]
my_dict = {}

# my_dict[my_list] = "Value" 
# TypeError 발생!

# 가능한 예 (튜플)
my_tuple = (1, 2)
my_dict[my_tuple] = "Value"
print(my_dict) # {(1, 2): 'Value'} -> 정상 작동

```

### ⚠️ 주의: 튜플 안의 리스트

튜플은 불변이지만, **튜플 안에 리스트(가변 객체)가 들어있다면** 그 튜플은 해시 불가능하다.

```python
t = (1, 2, [3, 4])
# print(hash(t)) # TypeError 발생! (내부의 리스트 값이 변할 수 있기 때문)

```

---

## 5. 요약 표

| 데이터 타입 | 가변성(Mutability) | 해시 가능성(Hashable) | Dict Key / Set 요소 가능? |
| --- | --- | --- | --- |
| **Integer, Float** | Immutable | O | **가능** |
| **String** | Immutable | O | **가능** |
| **Tuple** | Immutable | O (단, 내부 요소도 불변이어야 함) | **가능** |
| **List** | **Mutable** | X | **불가능** |
| **Set** | **Mutable** | X | **불가능** |
| **Dictionary** | **Mutable** | X | **불가능** |

---

✅ **다음 단계**
이제 파이썬의 데이터 타입과 구조에 대한 기초가 탄탄해졌다. 에러 처리에 대한 내용으로 넘어가서, **"프로그램이 죽지 않게 만드는 예외 처리 (try-except)"** 구문에 대해 정리해보자.